--Tabla CLIENTE	
CREATE TABLE CLIENTE(
	IDCLIENTE INT,
	NOMCLI VARCHAR(50),
	EMAIL VARCHAR(50),
	DIRECCION VARCHAR(50),
	DNI CHAR(9),
	TELEFONO BIGINT,
	CONSTRAINT PK_CLI PRIMARY KEY(IDCLIENTE)
)

--Tabla PEDIDO, hay que rellenar los estados completos
CREATE TABLE PEDIDO(
	IDPEDIDO INT, 
	FECHA DATETIME,
	ESTADOPEDIDO VARCHAR(20) NOT NULL CHECK(ESTADOPEDIDO IN('Enviado','En proceso','Fallido')),
	DATOSENVIO VARCHAR(100),
	IDCLIENTE1 INT,
	IDFACTURA1 INT,
	IDALBARAN1 INT,
	CONSTRAINT PK_PED PRIMARY KEY(IDPEDIDO),
	CONSTRAINT FK_FIDC FOREIGN KEY(IDCLIENTE1) REFERENCES CLIENTE(IDCLIENTE),	
)
--Tabla ALMACEN
CREATE TABLE ALMACEN(
	DIRECCION VARCHAR(100),
	NOMBRE VARCHAR(50),
	IDCLIENTE2 INT,
	CONSTRAINT PK_ALM PRIMARY KEY(DIRECCION),
	CONSTRAINT FK_IDC2 FOREIGN KEY(IDCLIENTE2) REFERENCES CLIENTE(IDCLIENTE)
)


--Tabla EMPLEADO
CREATE TABLE EMPLEADO(
	IDEMPLEADO INT,
	NOMBRE VARCHAR(50),
	DNI CHAR(9),
	IDPEDIDO1 INT,
	DIRECCION_ALMACEN VARCHAR(100),
	CONSTRAINT PK_EMP PRIMARY KEY(IDEMPLEADO),
	CONSTRAINT FK_DIR FOREIGN KEY(DIRECCION_ALMACEN) REFERENCES ALMACEN(DIRECCION)
)


CREATE TABLE OFERTA(
	CODIGO INT,
	FECHA DATETIME,
	PRECIOOFERTADO FLOAT,
	IDEMPLEADO1 INT,
	CONSTRAINT PK_OF PRIMARY KEY(CODIGO),
	CONSTRAINT FK_IDEM FOREIGN KEY(IDEMPLEADO1) REFERENCES EMPLEADO(IDEMPLEADO)
)

--Tabla PRODUCTO//PartNumber y Modelo hay que discutir que tipos llevar√°n
CREATE TABLE PRODUCTO(
	CODIGO VARCHAR(50),
	NOMBRE VARCHAR(50),
	DESCRIPCION VARCHAR(300),
	TIPOPRODUCTO VARCHAR(30) NOT NULL CHECK(TIPOPRODUCTO IN('equipoSoldadura','consumible','repuesto')),
	DISPONIBILIDAD VARCHAR(20) NOT NULL CHECK(DISPONIBILIDAD IN('Disponible','No disponible')),
	PRECIO FLOAT,
	URLDOCU VARCHAR(300),
	URLIMG VARCHAR(300),
	STOCK INT,
	PARTNUMBER INT,
	MODELO VARCHAR(100),
	CODIGOFERTA INT,
	CONSTRAINT PK_PRO PRIMARY KEY(CODIGO),
	CONSTRAINT FK_FCO FOREIGN KEY(CODIGOFERTA) REFERENCES OFERTA(CODIGO),
)


--Tabla LINEAPEDIDO
CREATE TABLE LINEAPEDIDO(
	NUMLINE INT,
	CANTIDADPEDIDO INT,
	PRECIOESPERADO FLOAT,
	CODIGOPRO VARCHAR(50),
	IDPEDIDO2 INT,
	CONSTRAINT PK_LINP PRIMARY KEY(NUMLINE),
	CONSTRAINT FK_COD FOREIGN KEY(CODIGOPRO) REFERENCES PRODUCTO(CODIGO),
	CONSTRAINT FK_FIDP2 FOREIGN KEY(IDPEDIDO2) REFERENCES PEDIDO(IDPEDIDO)
)


--Tabla Factura//Hay que rellenar las formas de pago
CREATE TABLE FACTURA(
	IDFACTURA INT,
	TIPOFORMAPAGO VARCHAR(20) NOT NULL CHECK(TIPOFORMAPAGO IN('','','')),
	PRECIOTOTAL FLOAT,
	IDPEDIDO3 INT,
	
	CONSTRAINT PK_FAC PRIMARY KEY(IDFACTURA),
	CONSTRAINT FK_FIDP3 FOREIGN KEY(IDPEDIDO3) REFERENCES PEDIDO(IDPEDIDO)
)

--Tabla Albaran
CREATE TABLE ALBARAN(
	IDALBARAN INT,
	IDPEDIDO4 INT,
	CONSTRAINT PK_ALB PRIMARY KEY(IDALBARAN),
	CONSTRAINT FK_FIDP4 FOREIGN KEY(IDPEDIDO4) REFERENCES PEDIDO(IDPEDIDO)
)